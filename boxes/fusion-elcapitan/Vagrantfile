# -*- mode: ruby -*-
# vi: set ft=ruby :
#
# Project:: Vagrant Boxes
#
# Copyright 2019, Route 1337, LLC, All Rights Reserved.
#
# Maintainers:
# - Matthew Ahrenstein: matthew@route1337.com
#
# See LICENSE
#

ENV['VAGRANT_DEFAULT_PROVIDER'] = 'vmware_fusion'

Vagrant.configure("2") do |config|


  config.vm.define :elcapitan do |elcapitan|

    elcapitan.vm.box = "fusion-elcapitan"
    elcapitan.vm.box_url = "http://vg.route1337.com/fusion-elcapitan.json"
    elcapitan.vm.hostname = "elcapitan.vg.route1337.com"
    elcapitan.vm.synced_folder "/Scratch/", "/Scratch"

    # VMware VM parameters (RAM, CPU etc)
    ["vmware_fusion", "vmware_workstation"].each do |vmware|
      elcapitan.vm.provider vmware do |v, override|
        v.vmx["memsize"] = "3072"
        v.vmx["numvcpus"] = "2"
        v.vmx["ethernet0.present"] = "TRUE"
        v.vmx["ethernet0.connectionType"] = "nat"
        v.vmx["ethernet0.virtualDev"] = "e1000e"
        v.vmx["ethernet0.wakeOnPcktRcv"] = "FALSE"
        v.vmx["ethernet0.addressType"] = "generated"
        #v.vmx["mks.enable3d"] = "TRUE"
        #v.vmx["svga.graphicsMemoryKB"] = "524288"
        v.gui = true
      end
    end

    # Private networking - so machines can speak to each other:
    elcapitan.vm.network :private_network, ip: "192.168.40.32"

    ## Provision with Ansible
    #elcapitan.vm.provision :ansible do |ansible|
    #  ansible.inventory_path = "../../ansible/vagrant.inv"
    #  ansible.playbook = "../../ansible/main.yml"
    #end
  end
end
